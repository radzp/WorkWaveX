<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Sharp" rel="stylesheet">
    <link rel="stylesheet"
          href="https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp:opsz,wght,FILL,GRAD@24,400,0,0"/>
    <link rel="stylesheet" href="../static/css/dashboard.css" th:href="@{/css/dashboard.css}">
    <link rel="stylesheet" type="text/css" href="../static/css/newLogin.css" th:href="@{css/newLogin.css}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.js"></script>

    <title>WorkWaveX</title>
</head>

<body>

<div class="container">
    <!-- Sidebar Section -->
    <aside>
        <div class="toggle">
            <div class="logo">
                <img src="../static/images/contact-person.png" th:src="@{/images/contact-person.png}">
                <h2>Work<span class="danger">WaveX</span></h2>
            </div>
            <div class="close" id="close-btn">
                    <span class="material-icons-sharp">
                        close
                    </span>
            </div>
        </div>

        <div class="sidebar">
            <a href="dashboard.html" th:href="@{/dashboard}">
                    <span class="material-icons-sharp">
                        dashboard
                    </span>
                <h3>Dashboard</h3>
            </a>
            <a href="employees.html" class="active" th:href="@{/employees}">
                    <span class="material-icons-sharp">
                        person_outline
                    </span>
                <h3>Employees</h3>
            </a>
            <a href="calendar.html" th:href="@{/calendar}">
                    <span class="material-icons-sharp">
                        calendar_today
                    </span>
                <h3>Calendar</h3>
            </a>
            <a href="activity.html" th:href="@{/activity}">
                    <span class="material-icons-sharp">
                        insights
                    </span>
                <h3>Activity</h3>
            </a>
            <a href="chat.html" th:href="@{/chat}">
                    <span class="material-icons-sharp">
                        mail_outline
                    </span>
                <h3>Chat</h3>
                <span class="message-count">27</span>
            </a>
            <a href="projects.html" th:href="@{/projects}">
                    <span class="material-icons-sharp">
                        inventory
                    </span>
                <h3>Projects</h3>
            </a>
            <a href="reports.html" th:href="@{/reports}">
                    <span class="material-icons-sharp">
                        report_gmailerrorred
                    </span>
                <h3>Reports</h3>
            </a>
            <a href="settings.html" th:href="@{/settings}">
                    <span class="material-icons-sharp">
                        settings
                    </span>
                <h3>Settings</h3>
            </a>
            <a href="newLogin.html" th:href="@{/newLogin}">
                    <span class="material-icons-sharp">
                        add
                    </span>
                <h3>New Login</h3>
            </a>
            <a href="#" th:href="@{/logout}">
                    <span class="material-icons-sharp">
                        logout
                    </span>
                <h3>Logout</h3>
            </a>
        </div>
    </aside>
    <!-- End of Sidebar Section -->

    <!-- Main Content -->
    <main>
        <h1>New Login</h1>
        <div class="register-group">
            <form action="#" method="post" onsubmit="onSubmit(event)">
                <div class="form-group">
                    <label for="firstName"><i class="fas fa-user"></i>First name:</label> <!-- Dodano ikonkę -->
                    <input type="text" id="firstName" name="firstName" required>
                </div>
                <div class="form-group">
                    <label for="lastName"><i class="fas fa-user"></i>Last name:</label> <!-- Dodano ikonkę -->
                    <input type="text" id="lastName" name="lastName" required>
                </div>

                <div class="form-group">
                    <label for="email"><i class="fas fa-envelope"></i>Email:</label> <!-- Dodano ikonkę -->
                    <input type="text" id="email" name="email" required>
                </div>

                <div class="form-group">
                    <label for="position"><i class="fas fa-briefcase"></i>Position:</label> <!-- Dodano ikonkę -->
                    <input type="text" id="position" name="position" required>
                </div>
                <div class="form-group">
                    <label for="role"><i class="fas fa-user-tag"></i>Role:</label> <!-- Dodano ikonkę -->
                    <select id="role" name="role">
                        <option value="USER" selected>USER</option>
                        <option value="ADMIN">ADMIN</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="salary"><i class="fas fa-dollar-sign"></i>Salary:</label> <!-- Dodano ikonkę -->
                    <input type="number" id="salary" name="salary" min="2700" required>
                </div>

                <div class="form-group">
                    <label for="phoneNumber"><i class="fas fa-phone"></i>Phone number:</label> <!-- Dodano ikonkę -->
                    <fieldset id="phoneNumber" class='number-code'>
                        <div>
                            <select name='areaCode' class='code-input' required>
                                <option value="+44">+44 (UK)</option>
                                <option value="+48">+48 (Poland)</option>
                                <option value="+49">+49 (Germany)</option>
                                <option value="+33">+33 (France)</option>
                                <option value="+39">+39 (Italy)</option>
                                <option value="+31">+31 (Netherlands)</option>
                                <option value="+34">+34 (Spain)</option>
                                <option value="+41">+41 (Switzerland)</option>
                                <option value="+43">+43 (Austria)</option>
                                <option value="+45">+45 (Denmark)</option>
                                <option value="+47">+47 (Norway)</option>
                                <option value="+46">+46 (Sweden)</option>
                                <option value="+30">+30 (Greece)</option>
                                <option value="+90">+90 (Turkey)</option>
                                <option value="+40">+40 (Romania)</option>
                                <option value="+36">+36 (Hungary)</option>
                                <option value="+32">+32 (Belgium)</option>
                            </select>
                            <input name='code' class='code-input' maxlength="1" type="text" pattern="\d" required/>
                            <input name='code' class='code-input' maxlength="1" type="text" pattern="\d" required/>
                            <input name='code' class='code-input' maxlength="1" type="text" pattern="\d" required/>
                            <input name='code' class='code-input' maxlength="1" type="text" pattern="\d" required/>
                            <input name='code' class='code-input' maxlength="1" type="text" pattern="\d" required/>
                            <input name='code' class='code-input' maxlength="1" type="text" pattern="\d" required/>
                            <input name='code' class='code-input' maxlength="1" type="text" pattern="\d" required/>
                            <input name='code' class='code-input' maxlength="1" type="text" pattern="\d" required/>
                            <input name='code' class='code-input' maxlength="1" type="text" pattern="\d" required/>
                        </div>
                    </fieldset>
                </div>
                <div class="form-group password-group">
                    <label for="password"><i class="fas fa-lock"></i>Password:</label> <!-- Dodano ikonkę -->
                    <input type="password" id="password" name="password" required>
                    <span class="show-password" id="showPassword">
                    <i class="far fa-eye"></i>
                </span>
                </div>
                <div class="form-group password-group">
                    <label for="repeatedPassword"><i class="fas fa-lock"></i>Repeated Password:</label>
                    <!-- Dodano ikonkę -->
                    <input type="password" id="repeatedPassword" name="repeatedPassword" required>
                    <span class="show-password" id="showRepeatedPassword">
                    <i class="far fa-eye"></i>
                </span>
                </div>
                <button type="submit"> Create a new employee account <i class="fas fa-sign-in-alt"></i></button>
                <!-- Dodano ikonkę -->
            </form>
        </div>


    </main>
    <!-- End of Main Content -->

    <!-- Right Section -->
    <div class="right-section">
        <div class="nav">
            <button id="menu-btn">
                    <span class="material-icons-sharp">
                        menu
                    </span>
            </button>
            <div class="light-mode">
                    <span class="material-icons-sharp">
                        light_mode
                    </span>
                <span class="material-icons-sharp active">
                        dark_mode
                    </span>
            </div>

            <div class="profile">
                <div class="info">
                    <p>Hey, <b>Reza</b></p>
                    <small class="text-muted">Admin</small>
                </div>
                <div class="profile-photo">
                    <img src="../static/images/profile-1.jpg" th:src="@{/images/profile-1.jpg}">
                </div>
            </div>

        </div>
        <!-- End of Nav -->


    </div>


</div>
</body>

<script>
    AOS.init();
    document.addEventListener('DOMContentLoaded', function () {
        var showPassword = document.getElementById('showPassword');
        var showRepeatedPassword = document.getElementById('showRepeatedPassword');
        var passwordInput = document.getElementById('password');
        var repeatedPasswordInput = document.getElementById('repeatedPassword');

        showRepeatedPassword.addEventListener('click', function () {
            if (repeatedPasswordInput.type === 'password') {
                repeatedPasswordInput.type = 'text';
                showRepeatedPassword.innerHTML = '<i class="far fa-eye-slash"></i>';
            } else {
                repeatedPasswordInput.type = 'password';
                showRepeatedPassword.innerHTML = '<i class="far fa-eye"></i>';
            }
        });
        showPassword.addEventListener('click', function () {
            if (passwordInput.type === 'password') {
                passwordInput.type = 'text';
                showPassword.innerHTML = '<i class="far fa-eye-slash"></i>';
            } else {
                passwordInput.type = 'password';
                showPassword.innerHTML = '<i class="far fa-eye"></i>';
            }
        });
    });


    // Pobierz pole wyboru kodu kierunkowego
    const areaCodeElement = document.querySelector('select[name="areaCode"]')

    // Pobierz wszystkie pola wprowadzania numeru telefonu
    const phoneInputElements = [...document.querySelectorAll('input.code-input')]

    // Dodaj nasłuchiwanie zdarzeń do każdego pola wprowadzania
    phoneInputElements.forEach((ele, index) => {
        ele.addEventListener('keydown', (e) => {
            if (e.keyCode === 8 && e.target.value === '') phoneInputElements[Math.max(0, index - 1)].focus()
        })
        ele.addEventListener('input', (e) => {
            // Przejdz do nastepnego pola po wprowadzeniu cyfry
            if (e.target.value.length === 1) {
                const nextField = phoneInputElements[index + 1];
                if (nextField) nextField.focus();
            }
        })
    })

    // Funkcja, która jest wywoływana podczas wysyłania formularza
    function onSubmit(e) {
        e.preventDefault()

        // Pobierz wartości z pól formularza
        const firstName = document.querySelector('input[name="firstName"]').value
        const lastName = document.querySelector('input[name="lastName"]').value
        const position = document.querySelector('input[name="position"]').value
        const email = document.querySelector('input[name="email"]').value
        const salary = document.querySelector('input[name="salary"]').value
        const password = document.querySelector('input[name="password"]').value
        const repeatedPassword = document.querySelector('input[name="repeatedPassword"]').value
        const role = document.querySelector('select[name="role"]').value


        // Sprawdź, czy hasła są takie same
        if (password !== repeatedPassword) {
            alert("Repeated password doesn't match with password");
            return;
        }

        // Pobierz wartość z pola wyboru kodu kierunkowego
        const areaCode = areaCodeElement.value

        // Pobierz wartości z każdego pola wprowadzania i połącz je razem, tworząc numer telefonu
        const phoneNumber = phoneInputElements.map(({value}) => value).join('')

        // Połącz kod kierunkowy z numerem telefonu
        const fullPhoneNumber = areaCode + phoneNumber

        // Utwórz obiekt z danymi formularza
        const registerData = {
            firstName,
            lastName,
            email,
            position,
            fullPhoneNumber,
            salary,
            password,
            role
        }
        // URL endpointu API rejestracji
        const registerUrl = 'http://localhost:8080/api/v1/auth/register';
        // Wykonaj żądanie POST do API rejestracji
        fetch(registerUrl, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(registerData)
        })
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                return response.json();
            })
            .then(data => {
                // Obsłuż odpowiedź z API
                console.log(data);
                alert("User created successfully!");
            })
            .catch(error => {
                // Obsłuż błąd
                console.error('Error:', error);
                alert("Failed to create user!");
            });
        console.log(registerData)

    }
</script>
</html>